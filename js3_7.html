<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prototype Chain Visualizer</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #141e30, #243b55);
    color: white;
    padding: 30px;
  }

  h1 {
    text-align: center;
  }

  select, button {
    padding: 8px 12px;
    margin: 10px 5px;
    border-radius: 6px;
    border: none;
    font-weight: bold;
  }

  button {
    background: #00c6ff;
    cursor: pointer;
  }

  .chain-container {
    margin-top: 20px;
  }

  .chain-node {
    background: #1e2a38;
    margin: 10px 0;
    padding: 12px;
    border-radius: 8px;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .chain-node:hover {
    background: #2e3f55;
    transform: scale(1.02);
  }

  .details {
    margin-top: 8px;
    font-size: 14px;
    color: #cfd8dc;
    display: none;
  }

  .level-label {
    font-weight: bold;
    color: #00e5ff;
  }
</style>
</head>
<body>

<h1>ðŸ”— Prototype Chain Visualizer</h1>

<select id="objectSelector">
  <option value="baseArmor">baseArmor (Armor instance)</option>
  <option value="nano">nano (NanoArmor instance)</option>
  <option value="suit">suit (Object.create(nano))</option>
</select>

<button onclick="inspectChain()">Inspect Prototype Chain</button>

<div class="chain-container" id="chainContainer"></div>

<script>

// ===== TASK 1: Setup Constructors =====

function Armor(type) {
  this.type = type;
}
Armor.prototype.getType = function() {
  return this.type;
};

function NanoArmor(type, enhancement) {
  Armor.call(this, type);
  this.enhancement = enhancement;
}
NanoArmor.prototype = Object.create(Armor.prototype);
NanoArmor.prototype.constructor = NanoArmor;
NanoArmor.prototype.getEnhancement = function() {
  return this.enhancement;
};

function PoweredSuit(name) {
  this.name = name;
}
PoweredSuit.prototype.activate = function() {
  return this.name + " activated";
};

// Instances
const baseArmor = new Armor("Standard");
const nano = new NanoArmor("Nano-X", "stealth");
const suit = Object.create(nano);
suit.name = "Mark-9";

// Safe object map (Bonus requirement)
const safeObjects = {
  baseArmor,
  nano,
  suit
};

// ===== TASK 2: Prototype Traversal =====

function getPrototypeChain(obj) {
  const chain = [];
  let current = obj;
  while (current !== null) {
    chain.push(current);
    current = Object.getPrototypeOf(current);
  }
  chain.push(null); // include null explicitly
  return chain;
}

function inspectChain() {

  const selectedName = document.getElementById("objectSelector").value;
  const obj = safeObjects[selectedName];

  const container = document.getElementById("chainContainer");
  container.innerHTML = "";

  const chain = getPrototypeChain(obj);

  chain.forEach((levelObj, index) => {

    const node = document.createElement("div");
    node.className = "chain-node";

    if (levelObj === null) {
      node.innerHTML = `<span class="level-label">[Level ${index}]</span> null`;
      container.appendChild(node);
      return;
    }

    const constructorName =
      levelObj.constructor?.name || "Anonymous/Plain Object";

    const isObjectProto =
      levelObj === Object.prototype ? " (Object.prototype)" : "";

    const ownKeys = Object.keys(levelObj);
    const ownProps = Object.getOwnPropertyNames(levelObj);

    node.innerHTML = `
      <span class="level-label">[Level ${index}]</span>
      Constructor: ${constructorName}${isObjectProto}
      <div class="details">
        Own Enumerable Keys: ${JSON.stringify(ownKeys)} <br>
        All Own Properties: ${JSON.stringify(ownProps)}
      </div>
    `;

    // Expand on click
    node.addEventListener("click", () => {
      const details = node.querySelector(".details");
      details.style.display =
        details.style.display === "block" ? "none" : "block";
    });

    container.appendChild(node);
  });
}

</script>

</body>
</html>
